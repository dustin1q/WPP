<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <meta name="theme-color" content="#232624">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <link rel="apple-touch-icon" href="solitaire_app_icon.png">
    <link rel="manifest" href="manifest.json">
    <title>Solitaire Pro</title>
    <link rel="stylesheet" href="styles.css">
</head>

<body>
    <div id="game-container">
        <header>
            <h3>Sampson Solitaire Game</h3>
            <div id="controls">
                <button id="new-game">New Game</button>
                <div id="stats">
                    <span>Score: <span id="current-score">0</span></span>
                    <span>High: <span id="high-score">0</span></span>
                    <span>Moves: <span id="move-count">0</span></span>
                    <span>Time: <span id="timer">00:00</span></span>
                </div>
            </div>
        </header>

        <main id="board">
            <div id="top-row">
                <div id="stock-container" class="pile-container">
                    <div id="stock" class="pile stock"></div>
                    <div id="waste" class="pile waste"></div>
                </div>
                <div id="foundations" class="pile-container">
                    <div id="foundation-0" class="pile foundation" data-suit="hearts"></div>
                    <div id="foundation-1" class="pile foundation" data-suit="diamonds"></div>
                    <div id="foundation-2" class="pile foundation" data-suit="clubs"></div>
                    <div id="foundation-3" class="pile foundation" data-suit="spades"></div>
                </div>
            </div>

            <div id="tableau">
                <div id="tableau-0" class="pile tableau"></div>
                <div id="tableau-1" class="pile tableau"></div>
                <div id="tableau-2" class="pile tableau"></div>
                <div id="tableau-3" class="pile tableau"></div>
                <div id="tableau-4" class="pile tableau"></div>
                <div id="tableau-5" class="pile tableau"></div>
                <div id="tableau-6" class="pile tableau"></div>
            </div>
        </main>

        <div id="win-overlay" class="hidden">
            <div class="win-content">
                <h2>You Win!</h2>
                <p>Final Score: <span id="final-score"></span></p>
                <p>Time: <span id="final-time"></span></p>
                <p>Moves: <span id="final-moves"></span></p>
                <button id="play-again">Play Again</button>
            </div>
        </div>
    </div>
    <script src="script.js"></script>
    <script>
        if ('serviceWorker' in navigator) {
            window.addEventListener('load', () => {
                navigator.serviceWorker.register('sw.js')
                    .then(reg => {
                        console.log('Service Worker registered:', reg);

                        // Check for updates on every launch
                        if (navigator.onLine) {
                            reg.update();
                        }

                        // When a new service worker takes over, reload the page
                        navigator.serviceWorker.addEventListener('controllerchange', () => {
                            window.location.reload();
                        });
                    })
                    .catch(err => console.log('Service Worker registration failed:', err));
            });
        }
    </script>
</body>

</html>